# Nome do nosso fluxo de trabalho (automa√ß√£o)
name: Atualizar Newsletter Semanal
# Adicionado para dar permiss√£o de escrita ao rob√¥
permissions:
  contents: write
# Gatilhos: O que faz a automa√ß√£o rodar?
on:
  workflow_dispatch:
  schedule:
    - cron: '0 8 * * 1' # Toda segunda-feira √†s 8h da manh√£ (hor√°rio UTC)

# Tarefas: O que o rob√¥ deve fazer?
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      # Passo 1: Baixa o c√≥digo do seu reposit√≥rio
      - name: Checkout do c√≥digo
        uses: actions/checkout@v3

      # Passo 2: Configura o ambiente Python
      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # Passo 3: Instala as ferramentas (bibliotecas)
      - name: Instalar depend√™ncias
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # Passo 4: Executa o seu script Python para gerar o novo newsletter.html
      - name: Gerar novo arquivo da Newsletter
        run: python update_newsletter.py

      # --- CORRE√á√ÉO APLICADA AQUI ---
     # Passo 5: For√ßa a adi√ß√£o do arquivo para o commit
      - name: Adicionar arquivo para commit
        run: git add newsletter.html

      # Passo 6: Faz o commit e push das altera√ß√µes
      - name: Commit e Push das altera√ß√µes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "üì∞ [Bot] For√ßa atualiza√ß√£o da newsletter"
          # N√£o especificamos mais o file_pattern, pois j√° adicionamos o arquivo manualmente
